<div class="hero-section">
    <div class="container">
        <div class="hero-content">
            <div class="d-flex align-items-center">
                <a href="/admin/users" class="btn btn-light btn-sm me-3">
                    <i class="bi bi-arrow-left"></i> Zpět na seznam
                </a>
                <div>
                    <div class="hero-badge">
                        <i class="bi bi-person-fill"></i>
                        Úprava uživatele
                    </div>
                    <h1 class="hero-title">{{ @user.name }}</h1>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container py-5">
    <div class="row">
        <div class="col-lg-10 mx-auto">
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-white">
                    <ul class="nav nav-tabs card-header-tabs" id="userTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="basic-tab" data-bs-toggle="tab" data-bs-target="#basic" type="button" role="tab" aria-controls="basic" aria-selected="true">
                                <i class="bi bi-person me-2"></i>Základní údaje
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact" type="button" role="tab" aria-controls="contact" aria-selected="false">
                                <i class="bi bi-telephone me-2"></i>Kontaktní údaje
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="diet-tab" data-bs-toggle="tab" data-bs-target="#diet" type="button" role="tab" aria-controls="diet" aria-selected="false">
                                <i class="bi bi-journal-text me-2"></i>Dietní plán
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="health-tab" data-bs-toggle="tab" data-bs-target="#health" type="button" role="tab" aria-controls="health" aria-selected="false">
                                <i class="bi bi-heart-pulse me-2"></i>Zdravotní údaje
                            </button>
                        </li>
                    </ul>
                </div>
                <div class="card-body">
                    <form method="POST" action="/admin/edit_user/{{ @user.id }}">
                        <div class="tab-content" id="userTabsContent">
                            <!-- Basic Information Tab -->
                            <div class="tab-pane fade show active" id="basic" role="tabpanel" aria-labelledby="basic-tab">
                                <div class="mb-3">
                                    <label for="name" class="form-label">Jméno a příjmení</label>
                                    <input type="text" class="form-control" id="name" name="name" value="{{ @user.name }}" required>
                                </div>

                                <div class="mb-3">
                                    <label for="email" class="form-label">Email</label>
                                    <input type="email" class="form-control" id="email" name="email" value="{{ @user.email }}" required>
                                </div>

                                <div class="mb-3">
                                    <label for="password" class="form-label">Heslo</label>
                                    <div class="input-group">
                                        <input type="password" class="form-control" id="password" name="password" placeholder="Ponechte prázdné pro zachování stávajícího hesla">
                                        <button class="btn btn-outline-secondary" type="button" id="togglePassword">
                                            <i class="bi bi-eye"></i>
                                        </button>
                                    </div>
                                    <div class="form-text">Vyplňte pouze v případě, že chcete změnit heslo uživatele.</div>
                                </div>

                                <div class="mb-3">
                                    <label for="role" class="form-label">Role</label>
                                    <select class="form-select" id="role" name="role">
                                        <option value="user" {{ @user.role=='user' ? 'selected' : '' }}>Uživatel</option>
                                        <option value="admin" {{ @user.role=='admin' ? 'selected' : '' }}>Administrátor</option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label for="active" class="form-label">Stav účtu</label>
                                    <select class="form-select" id="active" name="active">
                                        <option value="1" {{ @user.active=='1' ? 'selected' : '' }}>Aktivní</option>
                                        <option value="0" {{ @user.active=='0' ? 'selected' : '' }}>Neaktivní</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Contact Information Tab -->
                            <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">
                                <div class="mb-3">
                                    <label for="phone" class="form-label">Telefon</label>
                                    <input type="tel" class="form-control" id="phone" name="phone" value="{{ @user.phone }}">
                                </div>

                                <div class="mb-3">
                                    <label for="address" class="form-label">Adresa</label>
                                    <input type="text" class="form-control" id="address" name="address" value="{{ @user.address }}">
                                </div>

                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="city" class="form-label">Město</label>
                                        <input type="text" class="form-control" id="city" name="city" value="{{ @user.city }}">
                                    </div>

                                    <div class="col-md-6 mb-3">
                                        <label for="zip" class="form-label">PSČ</label>
                                        <input type="text" class="form-control" id="zip" name="zip" value="{{ @user.zip }}">
                                    </div>
                                </div>
                            </div>

                            <!-- Diet Plan Tab -->
                            <div class="tab-pane fade" id="diet" role="tabpanel" aria-labelledby="diet-tab">
                                <div class="mb-3">
                                    <label for="mealPlanLink" class="form-label">Odkaz na jídelníček</label>
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="bi bi-link-45deg"></i></span>
                                        <input type="text" class="form-control" id="mealPlanLink" name="meal_plan_link" value="{{ @user.meal_plan_link }}" placeholder="https://example.com/jidelnicek">
                                        <button class="btn btn-outline-primary" type="button" onclick="window.open(document.getElementById('mealPlanLink').value, '_blank')">
                                            <i class="bi bi-box-arrow-up-right"></i>
                                        </button>
                                    </div>
                                    <div class="form-text">Vložte odkaz na Google Dokument nebo jiný soubor s jídelníčkem.</div>
                                </div>

                                <div class="mb-3">
                                    <label for="dietType" class="form-label">Typ diety</label>
                                    <select class="form-select" id="dietType" name="diet_type">
                                        <option value="" {{ @user.diet_type=='' ? 'selected' : '' }}>Neurčeno</option>
                                        <option value="standard" {{ @user.diet_type=='standard' ? 'selected' : '' }}>Standardní</option>
                                        <option value="vegetarian" {{ @user.diet_type=='vegetarian' ? 'selected' : '' }}>Vegetariánská</option>
                                        <option value="vegan" {{ @user.diet_type=='vegan' ? 'selected' : '' }}>Veganská</option>
                                        <option value="lowcarb" {{ @user.diet_type=='lowcarb' ? 'selected' : '' }}>Nízkosacharidová</option>
                                        <option value="keto" {{ @user.diet_type=='keto' ? 'selected' : '' }}>Ketogenní</option>
                                        <option value="paleo" {{ @user.diet_type=='paleo' ? 'selected' : '' }}>Paleo</option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label for="dietNotes" class="form-label">Poznámky k dietě</label>
                                    <textarea class="form-control" id="dietNotes" name="diet_notes" rows="4">{{ @user.diet_notes }}</textarea>
                                </div>

                                <div class="mb-3">
                                    <label for="allergies" class="form-label">Alergie a nesnášenlivosti</label>
                                    <input type="text" class="form-control" id="allergies" name="allergies" value="{{ @user.allergies }}">
                                </div>
                            </div>

                            <!-- Health Information Tab -->
                            <div class="tab-pane fade" id="health" role="tabpanel" aria-labelledby="health-tab">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="height" class="form-label">Výška (cm)</label>
                                        <input type="number" class="form-control" id="height" name="height" value="{{ @user.height }}">
                                    </div>

                                    <div class="col-md-6 mb-3">
                                        <label for="weight" class="form-label">Váha (kg)</label>
                                        <input type="number" step="0.1" class="form-control" id="weight" name="weight" value="{{ @user.weight }}">
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="targetWeight" class="form-label">Cílová váha (kg)</label>
                                        <input type="number" step="0.1" class="form-control" id="targetWeight" name="target_weight" value="{{ @user.target_weight }}">
                                    </div>

                                    <div class="col-md-6 mb-3">
                                        <label for="birthday" class="form-label">Datum narození</label>
                                        <input type="date" class="form-control" id="birthday" name="birthday" value="{{ @user.birthday }}">
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label for="activity_level" class="form-label">Úroveň aktivity</label>
                                    <select class="form-select" id="activity_level" name="activity_level">
                                        <option value="sedentary" {{ @user.activity_level=='sedentary' ? 'selected' : '' }}>Sedavý způsob života</option>
                                        <option value="light" {{ @user.activity_level=='light' ? 'selected' : '' }}>Lehká aktivita (1-2x týdně)</option>
                                        <option value="moderate" {{ @user.activity_level=='moderate' ? 'selected' : '' }}>Střední aktivita (3-4x týdně)</option>
                                        <option value="high" {{ @user.activity_level=='high' ? 'selected' : '' }}>Vysoká aktivita (5-7x týdně)</option>
                                        <option value="athlete" {{ @user.activity_level=='athlete' ? 'selected' : '' }}>Profesionální sportovec</option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label for="health_notes" class="form-label">Zdravotní poznámky</label>
                                    <textarea class="form-control" id="health_notes" name="health_notes" rows="4">{{ @user.health_notes }}</textarea>
                                </div>
                            </div>
                        </div>

                        <div class="d-flex justify-content-between mt-4">
                            <a href="/admin/users" class="btn btn-outline-secondary">
                                <i class="bi bi-x-circle me-2"></i>Zrušit
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-check-circle me-2"></i>Uložit změny
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    /* Hero Section */
    .hero-section {
        background: linear-gradient(135deg, #1a237e, #3949ab);
        color: white;
        padding: 40px 0;
        margin-bottom: 30px;
    }

    .hero-badge {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        background: rgba(255, 255, 255, 0.2);
        padding: 8px 20px;
        border-radius: 50px;
        font-size: 0.9rem;
        font-weight: 600;
        margin-bottom: 10px;
    }

    .hero-title {
        font-size: 2rem;
        font-weight: 700;
    }

    /* Form styling */
    .form-control:focus, .form-select:focus {
        border-color: #3949ab;
        box-shadow: 0 0 0 0.25rem rgba(57, 73, 171, 0.25);
    }

    .btn-primary {
        background-color: #1a237e;
        border-color: #1a237e;
    }

    .btn-primary:hover {
        background-color: #3949ab;
        border-color: #3949ab;
    }

    /* Tab styling */
    .nav-tabs .nav-link {
        color: #495057;
    }

    .nav-tabs .nav-link.active {
        color: #1a237e;
        border-bottom-color: #1a237e;
        font-weight: 500;
    }

    .nav-tabs .nav-link:hover:not(.active) {
        border-color: transparent;
        color: #3949ab;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Toggle password visibility
        const togglePassword = document.getElementById('togglePassword');
        const password = document.getElementById('password');

        if (togglePassword && password) {
            togglePassword.addEventListener('click', function() {
                const type = password.getAttribute('type') === 'password' ? 'text' : 'password';
                password.setAttribute('type', type);

                // Toggle icon
                this.querySelector('i').classList.toggle('bi-eye');
                this.querySelector('i').classList.toggle('bi-eye-slash');
            });
        }
    });
</script>
